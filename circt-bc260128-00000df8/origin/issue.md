<!-- 
  CIRCT Bug Report
  Generated by circt-bug-reporter skill
-->
<!-- Title: [Moore] Assertion failure in MooreToCore when lowering string type module port -->

## Description

CIRCT's `circt-verilog` tool crashes with an assertion failure when processing a SystemVerilog module that uses a `string` type as an input port. The crash occurs during the MooreToCore conversion pass when constructing HW module port information.

The root cause is that the type converter maps `moore::StringType` → `sim::DynamicStringType` for module port types, but `sim::DynamicStringType` is not a valid HW dialect port type. When `hw::ModulePortInfo::sanitizeInOut()` attempts `dyn_cast<hw::InOutType>` on the unconvertible type, the assertion fires because `sim::DynamicStringType` isn't a valid target for HW dialect type casting.

**Crash Type**: assertion_failure
**Dialect**: Moore/SystemVerilog
**Failing Pass**: MooreToCore

## Steps to Reproduce

1. Save of test case below as `test.sv`
2. Run:
   ```bash
   circt-verilog --ir-hw test.sv
   ```

## Test Case

```systemverilog
module test(input string a);
endmodule
```

## Error Output

```
PLEASE submit a bug report to https://github.com/llvm/circt and include the crash backtrace.
Stack dump:
0.	Program arguments: /opt/firtool/bin/circt-verilog --ir-hw /home/zhiqing/edazz/eda-vulns/circt-bc260128-00000df8/origin/bug.sv
 #0 0x00007f7520a9d8a8 llvm::sys::PrintStackTrace(llvm::raw_ostream&, int)
 #4 0x00007f7524cbf8ae (anonymous namespace)::SVModuleOpConversion::matchAndRewrite(circt::moore::SVModuleOp, circt::moore::SVModuleOpAdaptor, mlir::ConversionPatternRewriter&) const MooreToCore.cpp:0:0
...
 circt-verilog: /home/zhiqing/edazz/FeatureFuzz-SV/target/circt-1.139.0-src/llvm/llvm/include/llvm/Support/Casting.h:650: decltype(auto) llvm::dyn_cast(From &) [To = circt::hw::InOutType, From = mlir::Type]: Assertion `detail::isPresent(Val) && "dyn_cast on a non-existent value"' failed.
```

## Root Cause Analysis

**Hypothesis**: The `getModulePortInfo()` function in `MooreToCore.cpp` (line 259) lacks validation to ensure converted port types are valid HW value types before constructing `hw::PortInfo`.

The call flow leading to the crash:
```
getModulePortInfo()
  → typeConverter.convertType(port.type)  // StringType → sim::DynamicStringType
  → hw::PortInfo construction
  → hw::ModulePortInfo(ports) constructor
    → sanitizeInOut()
      → dyn_cast<hw::InOutType>(p.type)  // CRASH: type is not valid for dyn_cast
```

**Key Issue**: `sim::DynamicStringType` is not compatible with the HW dialect's type system, yet the code assumes all converted port types are valid HW types that can be safely cast to `InOutType`.

## Environment

- **CIRCT Version**: firtool-1.139.0 (LLVM 22.0.0git)
- **OS**: Linux 5.15.0
- **Architecture**: x86_64

## Stack Trace

<details>
<summary>Click to expand stack trace</summary>

```
#0 0x00007f7520a9d8a8 llvm::sys::PrintStackTrace(llvm::raw_ostream&, int)
 #4 0x00007f7524cbf8ae (anonymous namespace)::SVModuleOpConversion::matchAndRewrite(circt::moore::SVModuleOp, circt::moore::SVModuleOpAdaptor, mlir::ConversionPatternRewriter&) const MooreToCore.cpp:0:0
 #5 0x00007f7524cbfb93 mlir::ConversionPattern::dispatchTo1To1<mlir::OpConversionPattern<circt::moore::SVModuleOp>, circt::moore::SVModuleOp>(mlir::OpConversionPattern<circt::moore::SVModuleOp> const&, circt::moore::SVModuleOp, circt::moore::SVModuleOp::GenericAdaptor<llvm::ArrayRef<mlir::ValueRange>>, mlir::ConversionPatternRewriter&)
 #6 0x00007f7524cbf530 mlir::OpConversionPattern<circt::moore::SVModuleOp>::matchAndRewrite(mlir::Operation*, llvm::ArrayRef<mlir::ValueRange>, mlir::PatternRewriter&) const
 #7 0x00007f7522fd1438 mlir::ConversionPattern::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&) const
 #8 0x00007f7522f9b8ed void llvm::function_ref<void ()>::callback_fn<mlir::PatternApplicator::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&, ...)::$_0>(long)
 #9 0x00007f7522f98774 mlir::PatternApplicator::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&, ...)
#10 0x00007f7522fd2c6f (anonymous namespace)::OperationLegalizer::legalize(mlir::Operation*)
#11 0x00007f7522fd2470 mlir::OperationConverter::convert(mlir::Operation*, bool)
#12 0x00007f7522fd2dae mlir::OperationConverter::convertOperations(llvm::ArrayRef<mlir::Operation*>)
#13 0x00007f7522fe08e4 void llvm::function_ref<void ()>::callback_fn<applyConversion(...)::$_0>(long)
#14 0x00007f7522fd7f7d applyConversion(llvm::ArrayRef<mlir::Operation*>, mlir::ConversionTarget const&, ...)
#15 0x00007f7522fd80fe mlir::applyFullConversion(mlir::Operation*, mlir::ConversionTarget const&, ...)
#16 0x00007f7524c91231 (anonymous namespace)::MooreToCorePass::runOnOperation() MooreToCore.cpp:0:0
```

</details>

## Related Issues

- #8332: [MooreToCore] Support for StringType from moore to llvm dialect (OPEN)
- #9199: [MooreToCore] Error out on conversions to unsupported types (CLOSED) - Previous fix for similar dyn_cast assertion failures, but appears incomplete for module port handling

---
*This issue was generated with assistance from an automated bug reporter.*
