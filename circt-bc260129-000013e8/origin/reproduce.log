=== CIRCT Reproduction Test ===
Date: Sun Feb  1 07:19:54 UTC 2026

=== Toolchain Versions ===
LLVM (http://llvm.org/):
  LLVM version 22.0.0git
  Optimized build.
CIRCT firtool-1.139.0
slang version 9.1.0+0

=== Reproduction Command ===
/opt/firtool/bin/circt-verilog --ir-hw source.sv | /opt/firtool/bin/arcilator

=== Test File ===
module MixPorts(
  input  logic signed [7:0] a,
  input  logic signed [7:0] b,
  output logic signed [7:0] result,
  inout  wire  signed [7:0] io_bus
);

  logic signed [7:0] c_reg;
  
  always_comb begin
    c_reg = a + b;
  end
  
  assign result = c_reg;
  assign io_bus = (c_reg > 0) ? c_reg : 8'bz;

endmodule
=== Generated MLIR ===
module {
  hw.module @MixPorts(in %a : i8, in %b : i8, out result : i8, in %io_bus : !llhd.ref<i8>) {
    %0 = comb.add %a, %b : i8
    hw.output %0 : i8
  }
}

=== Arcilator Processing ===
; ModuleID = 'LLVMDialectModule'
source_filename = "LLVMDialectModule"

declare void @exit(i32)

define void @MixPorts_eval(ptr %0) {
  %2 = load i8, ptr %0, align 1
  %3 = getelementptr i8, ptr %0, i32 1
  %4 = load i8, ptr %3, align 1
  %5 = add i8 %2, %4
  %6 = getelementptr i8, ptr %0, i32 3
  store i8 %5, ptr %6, align 1
  ret void
}

!llvm.module.flags = !{!0}

!0 = !{i32 2, !"Debug Info Version", i32 3}

=== Result ===
; ModuleID = 'LLVMDialectModule'
source_filename = "LLVMDialectModule"

declare void @exit(i32)

define void @MixPorts_eval(ptr %0) {
  %2 = load i8, ptr %0, align 1
  %3 = getelementptr i8, ptr %0, i32 1
  %4 = load i8, ptr %3, align 1
  %5 = add i8 %2, %4
  %6 = getelementptr i8, ptr %0, i32 3
  store i8 %5, ptr %6, align 1
  ret void
}

!llvm.module.flags = !{!0}

!0 = !{i32 2, !"Debug Info Version", i32 3}
SUCCESS: No crash detected
