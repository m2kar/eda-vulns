<!--
  CIRCT Bug Report
  Generated by circt-bug-reporter skill
-->

<!-- Title: [Moore] Assertion failure in MooreToCore when using string type as module port -->

## Description

circt-verilog crashes when processing a module with a `string` type port. When the Moore dialect converts SystemVerilog's `string` type to `sim::DynamicStringType`, the `sanitizeInOut()` method in `hw::ModulePortInfo` constructor attempts to perform `dyn_cast<hw::InOutType>` on this type, which causes an assertion failure because `sim::DynamicStringType` is not a valid HW dialect type.

**Crash Type**: assertion  
**Dialect**: Moore  
**Failing Pass**: MooreToCore (SVModuleOpConversion)

## Steps to Reproduce

1. Save the test case below as `test.sv`
2. Run:
   ```bash
   circt-verilog --ir-hw test.sv
   ```

## Test Case

```systemverilog
module top(input string a);
endmodule
```

## Error Output

```
PLEASE submit a bug report to https://github.com/llvm/circt and include the crash backtrace.
Stack dump:
0.	Program arguments: circt-verilog --ir-hw source.sv
...
Assertion `detail::isPresent(Val) && "dyn_cast on a non-existent value"' failed.
...
#11 0x00007f580ee4d2f5 llvm::sys::RunSignalHandlers() ...
#12 0x00007f58130718ae (anonymous namespace)::SVModuleOpConversion::matchAndRewrite(circt::moore::SVModuleOp, circt::moore::SVModuleOpAdaptor, mlir::ConversionPatternRewriter&) const MooreToCore.cpp:0:0
...
```

## Root Cause Analysis

The crash occurs in the `getModulePortInfo()` function during the MooreToCore conversion:

1. Moore dialect converts SystemVerilog `string` type to `sim::DynamicStringType`
2. `hw::ModulePortInfo` constructor calls `sanitizeInOut()` on all port types
3. `sanitizeInOut()` attempts `dyn_cast<hw::InOutType>` on each port type
4. Since `sim::DynamicStringType` is not an HW dialect type, the `dyn_cast` triggers an assertion failure

**Key issue**: `hw::ModulePortInfo::sanitizeInOut()` assumes all port types are HW dialect compatible, but `sim::DynamicStringType` is a Sim dialect type outside the HW type system.

**Suggested fix**: Validate port types before constructing `hw::PortInfo`. For unsupported types like `string`, emit a proper diagnostic error instead of crashing.

## Environment

- **CIRCT Version**: LLVM 22.0.0git (firtool-1.139.0)
- **OS**: Linux 6.1.0
- **Architecture**: x86_64

## Stack Trace

<details>
<summary>Click to expand stack trace</summary>

```
PLEASE submit a bug report to https://github.com/llvm/circt and include the crash backtrace.
Stack dump:
0.	Program arguments: circt-verilog --ir-hw source.sv
 #1 0x00007f580ee4f8a8 llvm::sys::PrintStackTrace(llvm::raw_ostream&, int)
 #2 0x00007f580ee4d2f5 llvm::sys::RunSignalHandlers()
 #3 0x00007f580ee50631 SignalHandler(int, siginfo_t*, void*)
 #4 0x00007f58130718ae (anonymous namespace)::SVModuleOpConversion::matchAndRewrite(circt::moore::SVModuleOp, circt::moore::SVModuleOpAdaptor, mlir::ConversionPatternRewriter&) const
 #5 0x00007f5813071b93 llvm::LogicalResult mlir::ConversionPattern::dispatchTo1To1<mlir::OpConversionPattern<circt::moore::SVModuleOp>, circt::moore::SVModuleOp>(mlir::OpConversionPattern<circt::moore::SVModuleOp> const&, circt::moore::SVModuleOp, circt::moore::SVModuleOp::GenericAdaptor<llvm::ArrayRef<mlir::ValueRange>>, mlir::ConversionPatternRewriter&) const
 #6 0x00007f5813071530 mlir::OpConversionPattern<circt::moore::SVModuleOp>::matchAndRewrite(mlir::Operation*, llvm::ArrayRef<mlir::ValueRange>, mlir::ConversionPatternRewriter&) const
 #7 0x00007f5811383438 mlir::ConversionPattern::matchAndRewrite(mlir::Operation*, mlir::PatternRewriter&) const
...
#16 0x00007f5813043231 (anonymous namespace)::MooreToCorePass::runOnOperation()
```

</details>

## Related Issues

- #8332: [MooreToCore] Support for StringType from moore to llvm dialect (feature request for StringType support, not this specific port crash)
- #8930: [MooreToCore] Crash with sqrt/floor (same assertion message but different crash location)

---
*This issue was generated with assistance from an automated bug reporter.*
